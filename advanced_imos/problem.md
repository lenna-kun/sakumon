# Advanced imos

## 問題

長さNの数列A({a_1,a_2,…,a_N})が与えられます．Q個のクエリを処理した後の数列Aを求めてください．

各クエリではL, X, Yが与えられる．

各i=L,L+1,…,Nについて，a_iを(X*a_i + Y) mod 1000000007に置き換える．

ただし，各クエリにおいて，Lの値は，それ以前のクエリに含まれるLの最大値以上のものが与えられます．

___Note: 遅延セグメント木，双対セグメント木を使わずに解いてください．___</b>

## 制約
- 1 <= N, Q <= 10000000
- 1 <= a_i, X, Y <= 1000000007
- 1 <= L <= N
- 入力は全て整数

## 入力

```
N Q
a_1 a_2 ... a_N
L_1 X_1 Y_1
L_2 X_2 Y_2
...
L_Q X_Q Y_Q
```

## 出力

```
a_1 a_2 ... a_N
```